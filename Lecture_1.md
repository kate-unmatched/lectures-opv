# Введение в курс

Был академик Самарский А.А. Является основоположником математического моделирования. Само математическое моделирование он разбил на три этапа, включив в него построение, собственно, математической модели, потом разработку численного метода и написание программного комплекса, который этот численный метод будет реализовывать.

> Александр Андреевич Самарский — известный специалист в области вычислительной математики, математической физики, теории математического моделирования. Создатель теории операторно-разностных схем, общей теории устойчивости разностных схем.
С 1948 года совместно с академиком А. Н. Тихоновым разрабатывал численные методы и вёл первые в СССР прямые расчёты мощности взрыва атомной, а позже — водородной бомбы, хорошо совпавшие с испытаниями. В этих работах были заложены основы математического моделирования и созданы важнейшие принципы конструирования и обоснования разностных схем и параллельных вычислений. А. А. Самарский был пионером в параллельной обработке потоков данных.

Нарисуем триаду Самарского:

![alt text](image-1.png)

Это может быть какой-то физический процесс, например дифракция света на каком-то оптическом элементе. Это может быть химический процесс, какая-то реакция. Это может быть гуманитарный процесс. Вот каким-то образом развивается общество, в нём происходят какие-то события: революции или эволюционные развития. Общество по численности людей растёт, или наоборот уменьшается, образуются классы, погибают. Всё это будет для нас объектом моделирования.

К сожалению, полностью записать объекты в виде модели со всеми его свойствами, или к счастью - невозможно, так как в этом случае модель станет самим объектом. Принято выделять из него какие-то характерные черты для типа нашего исследования.

![](image.png)'''

Ну например, если мы занимаемся задачей баллистики. Взяли и бросили камень под определённым углом под определённой силой, нам нужно узнать где он упадёт. Нам придётся записывать дифференциальное уравнение второго порядка, которое будет давать траекторию этого камня, а вот цвет камня нам неинтересен, белый он, чёрный он - на его баллистические характеристики это не влияет никак. То есть при этом моделировании чертами камня будут его масса, угол падения, сопротивление воздуха, объём и т.д. а цвет неинтересен. Если же нас интересуют опттические свойства камня, например, очень долгое время, пока люди ещё не высадились на луне, они изучали её на расстоянии. В том числе одним из главных инструментов этого изучения было изучение альбедо лунной поверхности, то есть отражающих свойств. Вот там цвет камня играл определяющую роль. То есть для задачи оптики цвет камня будет важен, а его масса и как мы его бросаем - уже не очень.

Следующим этапом после работы с объектом и выделения на нём характерных черт будет построение математической модели. Вспомним курс уравнений математической физики. Фактически, все эти уравнения - модели каких-либо физических процессов. Более того, часто бывает, что уравнение одно, а моделью оно служит для разных процессов. Например, возьмём уравнение теплопроводности, очевидно по названию, являющееся моделью процесса теплопроводности. Если у него же параметры уравнения иначе интерпретировать, допустим, не как температуру, а в виде концентрации вещества. оно же будет уравнением диффузии, а модель одна. 

То есть тут, как правило, какой-то математический объект. Иногда это дифференциальное уравнение, иногда это граф. То есть, например, моделировать можно работу программы. У нас есть программа, нам нужно построить её математическую модель. Программу можно выразить допустим через конечные автоматы.

Итак, есть матмодель. Это необязательно дифференциальное, интегральное уравнение, это может быть математический граф. Следующий этап - численные методы. Есл конечно у нас граф, то здесь небольшое разнообразие численных методов, но можно какой-то алгоритм обхода графа придумать. А вот если это дифференциальное уравнение, то появляются уже разные способы его решения. Например, есть аналитические методы, полуаналитические, где сочетается численное и аналитическое решения, есть чисто численные методы. Например, мы знаем о методе Эйлера, методе  Рунге-Кутты. 

> Метод Эйлера — простейший численный метод решения систем обыкновенных дифференциальных уравнений.

> Методы Рунге — Кутты — большой класс численных методов решения задачи Коши для обыкновенных дифференциальных уравнений и их систем.

Несмотря на довольно почтенную историю математики и не менее почтенную историю численных методов, о ней заговорили только недавно, более века назад. Рунге стал профессором, когда ему было уже хорошо за 70. Ему говорили, что численные методы - это для дурачков. Если есть задача, то подлинный математик должен решить всё аналитически. Записать формулу и по формуле всё рассчитать. Если аналитически он её не решит - то он дурак. Так Рунге всю сознательную жизнь троллили. Толчком к принятию численных методов как полноценного инструмента математики стала первая мировая война.

Мы занимаемся тем, что реализуем это всё в виде программы, это программная реализация. Ещё одна важная вещь, о которой Самарский не упоминает - процесс моделирования обязательно необходимо завершать проверкой адекватности модели. С первого раза почти ничего получится, поэтому существует такая проверка. Те ли черты объекта мы взяли? Ту ли математическую модель построили? Например, мы изучаем эффект Комптона. Это когда свет неожиданно начинает проявлять корпускулярные свойства. Свет - это же одновременно и волна, и частица. 

Допустим, что мы выделили из модели не то свойство, не корпускулярное, а волновое. Изучая волновое свойство, эффекта Комптона мы не получим. Записали для него уравнение Максвелла, решили его численно, составили программку. Вычисляем, а эффекта нет. Ну естественно, мы же не те свойства у модели выделили. Допустим, что мы наконец догадались, что свойства корпускулярные, и решать нужно не уравнение Максвелла, а допустим, уравнение Шрёдингера. Записали это уравнение, но решили выбрать для него явный численный метод. А явные схемы все для него расходятся, не получили решение. И вот так, проходя по каждому из этапов вплоть до последнего этапа программной реализации, нам приходится всё это дело просматривать.

Чем ценна эта триада Самарского? Тем, что на её примере очень легко разбирать место того или иного курса в системе обучения. Если изучаете физику, то значит изучаете объект моделирования, если дифференциальные уравнения - значит, конкретные математические модели. если изучаем численные методы - значит изучаем способы решения математических моделей. Посмотрим, где наш предмет:

![](image-2.png)

Какие свойства численных методов помним? Устойчивость, единственность решения и его существование (корректность). 

Проблема нашего курса - чтобы метод считался быстро. Например, задача умножения матриц. Она кажется простенькой, но решается очень долго, так как у неё колоссальная вычислительная сложность - U(n^2). Естественно, хотелось чтобы всё решалось быстрее. 

В математике для этого есть такое понятие как вычислительная сложность метода. При прочих равных предпочтение отдаётся тому методу, у кого она меньше. К сожалению, математики часто неверно интерпретируют вычислительную сложность как количество арифметических операций. Дело в том, что кроме количества арифметических операций есть ещё операции, которые делает компьютер. Он выделяет память, обращается к памяти. И очень часто численный метод, который характеризуется меньшим количеством арифметических операций, работает дольше из-за неуклюжей работы с памятью. У нас операции делаются в регистрах процессора. А до попадания в регистры нужно информации нужно быть считанной из оперативной памяти, пройти через все кэши процессора. Потом попасть в регистр, там с ней сделают что-то. И информация пойдёт обратно.

Все эти операции на современных процессах делаются одновременно, но всё это очень существенно влияет на характеристики метода. Наша главная цель курса - заниматься теми численными методами, которые работают быстро. Если вы заметили, то математикам неинтересно, как устроена архитектура компьютера. Они под "быстро" имеют в виду количество арифметических операций. Для нас же архитектура компьютера будет очень важна. Это особенность нашего курса - учёт архитектуры электронно-вычислительной машины. Это то, что отличает наши численные методы от всех остальных.

У нас главной целью будет создать численный метод, который на определённой архитектуре, а их довольно много, будет работать быстро, или по крайней мере быстрее аналогов.

Подумаем, какие же архитектурные особенности бывают, какие нужно учитывать. Открыли мы системный блок. Что там такого, что нам придётся учитывать? Объём памяти, иерархическая структура памяти, скорость шин данных, количество ядер. Одно дело создать численный метод для одного ядра, другое дело - для двух. Например, есть метод прогонки для решения системы трёхдиагональных уравнений. Иногда его называют метод Томаса (в России придумал академик Гильфандо). Он состоял из двух этапов. У нас есть матрица трёхдиагональная и матрица системы, которую нужно решить. На первом этапе, так называемом прямой прогонкой, находились прогоночные коэффициенты `alfa` и `beta`. Находились обязательно рекуррентно. Сначала `alfa1`, потом `alfa2`, и также с beta. Нельзя было найти прогоночный коэффициент с некоторым номером без нахождения коэффициентов с номером ниже этого. Потом начинался обратный ход прогонки, где мы находили из прогоночных коэффициентов неизвестные системы, уже в порядке убывания номеров.

Это означает, что будь у нас хоть два ядра, хоть 200 ядер, мы не сможем их загрузить работой. Если мы собираемся рещать вот эту задачу, то метод прогонки нам не годится. Нужно придумывать новые методы.

Есть особенности архитектуры, под которые известные методы просто могут не подходить. Значит нужно использовать старые другие, или придумывать новые, вычисления по которым можно будет организовать одновременно (паралелльно).

А как именно всё это выдумывается? Допустим, нас вызвали в институт, который занимается биологическими исследованиями и сказали: "Вот мы тут изучаем структуру белка. Очень простенькая задача, даже есть программка готовая. И раньше нас вполне устраивало, как она работает, а теперь информации в 100 раз больше, и нам хотелось бы, чтобы нам дали многоядерный процессор, а лучше суперкомпьютер. И вы, учитывая такой большой объём информации быстро нам всё решите, ну хотя бы за сутки". 